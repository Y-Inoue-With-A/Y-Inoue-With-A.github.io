---
title: "VBAを理解するために"
date: 2022-03-17T23:46:19+09:00
draft: true
---

　VBA理解するには、ずばりオブジェクト指向というものの概念を掴むことです。
この時点で、たぶん巷に売っているような参考書とは違った説明になるかと思います。
 いきなり「オブジェクト指向なんて専門的な用語出すな」と怒られそうですが、私自身、1500行程度のプログラムを業務でコーディングしたりしましたが、いまだにオブジェクト指向の専門的なことは分かりません。ただざっくり、そして十分な概念として、いわゆる”物に対して指示を出す”という認識でＯＫです。VBAは立派なオブジェクト指向言語だと私は思います。（VBAはオブジェクト指向言語といえますが、一部通常のオブジェクト指向が備えている機能を持っていません）

 　前述した、”物に対して指示を出す”というのは、どういうことかというと、通常一般的な言語では、bitだのByteだのレジスタ（コンピュータの特赦な記憶領域だと思ってください）などに、細かいことをつらつら記述して、ある特定の記憶場所に対して1だの0だの細かい値を書き込んで、使用したい機能を使用します。これは、第三者が見ると、極めて何を行っているか理解できないコードになります。例えば、この細かい指示を、「この機能を利用する」という、状態になるまでの命令や設定をまとまりにして、他の人で利用しやすいように、簡単な命令に置き換えて、利用できるようにしてしまう、これがオブジェクト指向の根底の考え方であると思います。いわゆるサブルーチンに、仮想的に物の名前を振ってしまうということです。

 　まさに、このまとまりのプログラムに仮想的に物の名前を割り当てて、利用している側からすると、物に対して命令しているかのように見せております。
 　例えば、Workbookオブジェクトなんて物があります。これはExcelbookその物です。この実態は、そのExcelファイルを探して、利用するための複雑なプログラムコードがバックグラウンドにあるプログラム集的な物にすぎません。
 　「ブックを開く」なんてことをやりたかったら、Workbooks.Openとなるわけです。イメージ沸きましたかね。巷の本では、オブジェクトは物です。というような説明で終わってしまい、私も意味不明でした。これは正確には間違いで、その物を特定して、利用できる機能などの複雑なプログラムを利用しやすいように、塊にして物をイメージさせたり、動作をイメ―ジさせるような名前に置き換えただけです。

 　ずばり、オブジェクトとは

 　　操作対象とするものを指し示して、その対象でできる機能を利用するためのプログラムの塊の寄せ集めです。伝わったかな？

 　私の経験上、オブジェクト、メソッド、プロパティの概念が理解できてから、飛躍的に複雑なコードを書けるようになったので、長ったらしく書きました。